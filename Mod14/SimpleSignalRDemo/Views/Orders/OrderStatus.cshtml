
@{
    ViewBag.Title = "OrderStatus";
}

<h2>OrderStatus</h2>

<div class="container">
    <div class="row col-md-6">
        <br />
        <h2>Simple dashboard</h2>
        <div class="panel panel-default">
            <div class="panel-body">
                <table id="orders" class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th>Orderdate</th>
                            <th>Customer</th>
                            <th>Product</th>
                            <th>Quantity</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script src="~/Scripts/jquery-3.3.1.min.js"></script>
<script src="~/Scripts/jquery.signalR-2.4.0.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>

<script type="text/javascript">
    $(function () {
        //Get the connection to the server hub.
        var connection = $.hubConnection();
        //Create the hubproxy.
        var hub = connection.createHubProxy('OrderStatusHub');

        //Activate logging. You can see the output in the developer tools console window.
        connection.logging = true;

        //Connect the callback method. For each new order row add it to the table.
        hub.on('onAddOrder', function (value) {
            $("#orders tbody").html('');
            $(value).each(function () {
                $("#orders tbody").append(
                    "<tr>" +
                    "<td>" + this.OrderDate + "</td>" +
                    "<td>" + this.CustomerName + "</td>" +
                    "<td>" + this.ProductName + "</td>" +
                    "<td>" + this.Quantity + "</td>" +
                    "</tr>");
            });
        });

        //Start the communication.
        connection.start().done(function () {
        });
    })</script>